<header th:fragment="header" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <div class="header-menubar">
        <div class="header-logo">
            <a th:href="@{/}" class="d-inline-block">
                <img th:src="@{/image/logo_garo_white.png}" alt="FindInn Logo" loading="eager">
            </a>
        </div>
        
        <nav class="header-menu" role="navigation" aria-label="주요 메뉴">
            <div class="menu">
                <div class="menu-item-event">
                    <a th:href="@{/event/eventlist}" aria-label="이벤트 페이지로 이동">
                        <i class="fas fa-gift me-2"></i>이벤트
                    </a>
                </div>
                <div class="menu-item-qna">
                    <a sec:authorize="isAnonymous()||hasRole('USER')" th:href="@{/qna}" aria-label="고객문의 페이지로 이동">
                        <i class="fas fa-headset me-2"></i>고객문의
                    </a>
                    <a sec:authorize="hasRole('ADMIN')" th:href="@{/admin/qna}" aria-label="관리자 고객문의 페이지로 이동">
                        <i class="fas fa-headset me-2"></i>고객문의
                    </a>
                    <a sec:authorize="hasRole('MANAGER')&&!hasRole('ADMIN')" th:href="@{/manage/qna}" aria-label="매니저 고객문의 페이지로 이동">
                        <i class="fas fa-headset me-2"></i>고객문의
                    </a>
                </div>
                <div class="menu-item-bookingSearch">
                    <a sec:authorize="isAnonymous()" th:href="@{/booking/search}"><i class="fas fa-magnifying-glass me-2"></i>예약조회</a>
                    <a sec:authorize="isAuthenticated()" th:href="@{/mypage/reserve}"><i class="fas fa-magnifying-glass me-2"></i>예약조회</a>
                </div>
                <div class="menu_item_hotel">
                    <a sec:authorize="hasRole('ADMIN')" th:href="@{/admin/memberlist}" aria-label="호텔 관리 페이지로 이동">
                        <i class="fas fa-hotel me-2"></i>Hotel
                    </a>
                </div>
                <div class="menu_item_manager" th:switch="${#authorization.expression('hasRole(''MANAGER'')')}">
                    <a th:case="true" sec:authorize="!hasRole('ADMIN')" th:href="@{/manage/hotel}" aria-label="매니저 관리 페이지로 이동">
                        <i class="fas fa-cog me-2"></i>Manage
                    </a>
                    <a sec:authorize="isAuthenticated() and !hasRole('ADMIN')" th:case="false" th:href="@{/manage/application}" aria-label="매니저 신청 페이지로 이동">
                        <i class="fas fa-user-plus me-2"></i>신청
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="header-login" th:switch="${#authorization.expression('isAuthenticated()')}">
            <button th:case="false" class="btn btn-info btn-lg" data-bs-toggle="modal" data-bs-target="#loginModal" aria-label="로그인 모달 열기">
                <i class="fas fa-sign-in-alt me-2"></i>로그인
            </button>
            <section th:case="true" class="d-flex align-items-center">
                <div class="user-profile-dropdown dropdown">
                    <button class="btn p-0 border-0 bg-transparent" data-bs-toggle="dropdown" aria-expanded="false" aria-label="사용자 메뉴">
                        <i class="fa-solid fa-circle-user fa-2xl text-white"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow-lg">
                        <li><a class="dropdown-item" th:href="@{/mypage/reserve}"><i class="fas fa-calendar-check me-2"></i>예약 내역</a></li>
                        <li><a class="dropdown-item" th:href="@{/mypage/review}"><i class="fas fa-star me-2"></i>내 리뷰</a></li>
                        <li><a class="dropdown-item" th:href="@{/mypage/qna}"><i class="fas fa-comments me-2"></i>문의 내역</a></li>
                        <li><a class="dropdown-item" th:href="@{/mypage/update}"><i class="fas fa-user-edit me-2"></i>정보 수정</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <form action="/logout" method="post" class="d-inline w-100">
                                <button type="submit" class="dropdown-item text-danger">
                                    <i class="fas fa-sign-out-alt me-2"></i>로그아웃
                                </button>
                            </form>
                        </li>
                    </ul>
                </div>
            </section>
        </div>
    </div>
    
    
    
    
    <!-- Enhanced Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content border-0 shadow-2xl">

                <!-- Modal Header -->
                <div class="modal-header border-0 pb-0">
                    <div class="w-100 text-center">
                        <img src="/image/logo_garo.png" alt="FindInn Logo" class="mb-3">
                        <h4 class="modal-title text-primary fw-bold" id="loginModalLabel">FindInn에 오신 것을 환영합니다</h4>
                        <p class="text-muted mb-0">완벽한 숙박을 찾아드립니다</p>
                    </div>
                    <button type="button" class="btn-close position-absolute top-0 end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Modal body -->
                <div class="modal-body px-5 pb-5">
                    <section class="login-selector">
                        <div class="text-center mb-4">
                            <h5 class="text-dark mb-3">로그인 방법을 선택해주세요</h5>
                        </div>
                        
                        <button class="email-login mb-3">
                            <i class="fas fa-envelope me-2"></i>Email로 로그인
                        </button>
                        
                        <div class="social-login-divider d-flex align-items-center my-4">
                            <hr class="flex-grow-1">
                            <span class="px-3 text-muted small">또는</span>
                            <hr class="flex-grow-1">
                        </div>
                        
                        <!-- 네이버 로그인 -->
                        <form th:action="@{/oauth2/authorization/naver}" method="get" class="mb-3">
                            <button type="submit" class="social-login-btn naver-login">
                                <img src="/image/btnG_완성형.png" alt="네이버 로그인">
                            </button>
                        </form>
                        
                        <!-- 카카오 로그인 -->
                        <form th:action="@{/oauth2/authorization/kakao}" method="get">
                            <button type="submit" class="social-login-btn kakao-login">
                                <img src="/image/kakao_login_medium_narrow.png" alt="카카오 로그인">
                            </button>
                        </form>
                    </section>
                    <section class="login-form d-none">
                        <div class="text-center mb-4">
                            <button type="button" class="btn btn-outline-secondary btn-sm back-to-selector">
                                <i class="fas fa-arrow-left me-2"></i>다른 방법으로 로그인
                            </button>
                        </div>
                        
                        <form action="/login" method="post" id="sign-form" class="needs-validation" novalidate>
                            <div class="form-group mb-3">
                                <label for="memberEmail" class="form-label fw-semibold">이메일 주소</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fas fa-envelope text-muted"></i></span>
                                    <input type="email" class="form-control" id="memberEmail" name="memberEmail" placeholder="example@findinn.com" required>
                                </div>
                            </div>

                            <section class="after-click d-none">
                                <div class="form-group mb-3">
                                    <label for="password" class="form-label fw-semibold">비밀번호</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-lock text-muted"></i></span>
                                        <input type="password" class="form-control" name="memberPassword" id="password" placeholder="비밀번호를 입력하세요" required>
                                    </div>
                                </div>
                                

                                <section class="signin-form d-none">
                                    <div class="form-group mb-3">
                                        <label for="password-repeat" class="form-label fw-semibold">비밀번호 확인</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-lock text-muted"></i></span>
                                            <input type="password" id="password-repeat" class="form-control" placeholder="비밀번호를 다시 입력하세요" required>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group mb-3">
                                        <label for="memberName" class="form-label fw-semibold">이름</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-user text-muted"></i></span>
                                            <input type="text" name="memberName" id="memberName" class="form-control" placeholder="홍길동" required>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group mb-3">
                                        <label for="memberPhone" class="form-label fw-semibold">전화번호</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-phone text-muted"></i></span>
                                            <input type="tel" id="memberPhone" name="memberPhone" class="form-control" placeholder="010-1234-5678" required>
                                        </div>
                                        <div class="mt-2">
                                            <button type="button" id="sendAuthBtn-signup" class="btn btn-outline-primary w-100">
                                                <i class="fas fa-paper-plane me-2"></i>인증번호 받기
                                            </button>
                                        </div>
                                    </div>

                                    <div id="authSection-signup" style="display:none;" class="form-group mb-3">
                                        <label for="authInput-signup" class="form-label fw-semibold">인증번호</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-key text-muted"></i></span>
                                            <input type="text" id="authInput-signup" class="form-control" placeholder="6자리 인증번호 입력" maxlength="6" required>
                                        </div>
                                        <div class="mt-2">
                                            <button type="button" id="checkAuthBtn-signup" class="btn btn-outline-success w-100">
                                                <i class="fas fa-check me-2"></i>인증번호 확인
                                            </button>
                                        </div>
                                        <input type="hidden" id="serverAuthCode-signup" value="">
                                        <div id="timerText-signup" class="form-text text-muted mt-2"></div>
                                        <div id="authResultMsg-signup" class="form-text mt-2"></div>
                                    </div>
                                </section>
                            </section>
                            
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary btn-lg" id="login-btn" type="button">
                                    <i class="fas fa-sign-in-alt me-2"></i>로그인
                                </button>
                            </div>
                        </form>
                    </section>
                </div>
                
                <!-- Modal footer -->
                <div class="modal-footer border-0 pt-0">
                    <div class="w-100 text-center">
                        <small class="text-muted">
                            로그인 시 <a href="#" class="text-primary">이용약관</a> 및 <a href="#" class="text-primary">개인정보처리방침</a>에 동의하는 것으로 간주됩니다.
                        </small>
                    </div>
                </div>

            </div>
        </div>
    </div>

</header>