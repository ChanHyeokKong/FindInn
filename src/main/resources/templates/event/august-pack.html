<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}"
      lang="ko">

<th:block layout:fragment="head">
  <!-- Font Awesome (사용 시) -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer">

  <style>
    /* ===== BRAND TOKENS ===== */
    :root{
      --bg:#fdfefe; --card:#ffffff; --ink:#0f172a; --muted:#667085;
      --shadow:0 16px 40px rgba(15,23,42,.08); --r:20px;

      --brand:#1b6eea;      /* 블루 */
      --accent:#1fd6b6;     /* 민트 */
      --cta:#ff4d57;        /* 포인트 레드 */

      --grad-1:#eaf5ff;     /* 하늘 */
      --grad-2:#ffffff;

      --btn-shadow:0 10px 18px rgba(255,77,87,.22);
      --badge-bg: var(--cta); --badge-ink:#fff;

      --pill-bg:#f0f7ff; --pill-ink:#2a60ff;
      --bignum-border:#cfe6ff;
    }

    /* 모션 최소화 지원 */
    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; }
    }

    body{
      margin:0; font-family:var(--font-family-base, ui-sans-serif, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', sans-serif);
      color:var(--ink); background:var(--bg); font-size:var(--font-size-base, 16px);
    }
    .wrap{ max-width:1040px; margin:28px auto; padding:0 16px; }

    /* ===== HERO ===== */
    .hero{
      border-radius:28px; box-shadow:var(--shadow);
      background:linear-gradient(120deg, var(--grad-1), var(--grad-2));
      padding:26px 22px; display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .ribbon{
      display:inline-block; background:var(--badge-bg); color:var(--badge-ink);
      border-radius:999px; padding:8px 14px; font-weight:900; font-size:12px;
    }
    .hero-title{ margin:10px 0 6px; font-size:28px; line-height:1.1; letter-spacing:-.4px; font-weight:900; }
    .hero-title span{ color:var(--cta); }
    .hero-foot{ color:var(--muted); font-size:11px; }
    .count{ font-size:12px; color:var(--cta); font-weight:800; margin-top:6px; }

    .btn{
      border:0; padding:12px 18px; border-radius:14px; font-weight:900; cursor:pointer; font-size:var(--font-size-sm, 14px);
      display:inline-flex; align-items:center; gap:6px;
    }
    .btn-primary{ background:var(--cta); color:#fff; box-shadow:var(--btn-shadow); }
    .btn[disabled]{ background:#e5e7eb; color:#94a3b8; cursor:not-allowed; }

    /* ===== COUPON BANNER ===== */
    .banner{
      display:grid; grid-template-columns:140px 1fr auto; gap:18px;
      background:var(--card); border-radius:24px; box-shadow:var(--shadow);
      padding:20px 22px; margin-top:16px; align-items:center;
    }
    /* ✅ 숫자: 더 슬림(700) + 수직 그라데이션 더 또렷하게 */
    .bignum{
      width:140px; height:86px; border:2px dashed var(--bignum-border); border-radius:16px; background:#fff;
      display:flex; align-items:center; justify-content:center; font-weight:700; font-size:38px; letter-spacing:-.8px;
      background-clip:text; -webkit-background-clip:text; color:transparent;
      /* 더 또렷한 수직 그라데이션 */
      background-image:linear-gradient(180deg,#7fb1ff 0%, #2f6bff 55%, #123bff 100%);
      text-shadow:0 1px 0 rgba(0,0,0,.06), 0 8px 20px rgba(27,110,234,.08);
      line-height:1;
    }
    .bignum--won{ font-size:28px; letter-spacing:-.4px; padding:0 6px; }

    .line1{ font-weight:900; font-size:16px; color:var(--ink); }
    .line2,.line3{ color:var(--muted); font-size:12px; line-height:1.45; margin-top:3px; }
    .sep{ height:1px; background:linear-gradient(90deg,transparent,#e6e9ef,transparent); margin:22px 0; }

    /* ===== HOTEL ===== */
    .hotel{
      display:flex; gap:18px; align-items:center; background:#f9fdff; border-radius:24px; box-shadow:var(--shadow);
      padding:18px; margin-top:16px;
    }
    .hotel img{ width:48%; max-height:240px; object-fit:cover; border-radius:16px; }
    .hotel .info{ flex:1; }
    .pill{
      display:inline-flex; align-items:center; gap:6px; background:var(--pill-bg); color:var(--pill-ink);
      padding:6px 10px; border-radius:999px; font-weight:800; font-size:11px;
    }
    .hotel-title{ margin:8px 0 4px; font-size:18px; font-weight:900; }
    .hotel-desc{ margin:0; color:var(--muted); font-size:12px; line-height:1.4; }

    /* ===== MOBILE ===== */
    @media (max-width: 820px){
      .banner{ grid-template-columns:110px 1fr; gap:12px; padding:16px 16px; }
      .bignum{ width:110px; height:72px; font-size:32px; }
      .line1{ font-size:15px; }
      .line2, .line3{ font-size:11px; }
      .hero{ flex-direction:column; align-items:flex-start; gap:12px; }
    }
  </style>
</th:block>

<div layout:fragment="content">
  <div class="wrap">
    <!-- ===== HERO ===== -->
    <section class="hero" aria-labelledby="heroTitle">
      <div>
        <span class="ribbon">8월까지 쭉 숙소 최대할인! ✈️</span>
        <h1 id="heroTitle" class="hero-title">숙소 <span>최대 10%</span> 쿠폰팩 🏖️</h1>
        <div class="hero-foot">쿠폰 혜택은 숙소/체크인 기간/적용 시점에 따라 달라질 수 있습니다.</div>
        <div class="count" th:text="'현재 발급 : ' + (${issuedCount}?:0) + ' / ' + (${packSize}?:3)">현재 발급 : 0 / 3</div>
      </div>

      <!-- 팩 일괄 발급 -->
      <form th:action="@{/event/coupon/issue-pack}" method="post" aria-label="쿠폰팩 일괄 발급">
        <div th:if="${_csrf} != null">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </div>
        <button class="btn btn-primary" type="submit"
                th:disabled="${(issuedCount ?: 0) >= (packSize ?: 3)}"
                aria-disabled="${(issuedCount ?: 0) >= (packSize ?: 3)}"
                th:aria-label="${(issuedCount ?: 0) >= (packSize ?: 3)} ? '발급 마감' : '쿠폰팩 다운받기'">
          <i class="fa-solid fa-gift" aria-hidden="true"></i> 쿠폰팩 다운받기
        </button>
      </form>
    </section>

    <!-- ===== 7% ===== -->
    <article class="banner" aria-labelledby="coupon7Title">
      <div class="bignum" aria-hidden="true">7%</div>
      <div>
        <div id="coupon7Title" class="line1">숙소 7% 할인 🎉</div>
        <div class="line2">8만원 이상 · 최대 20,000원</div>
        <div class="line3">사용기간: 발급일로부터 10일 (8/31 만료)</div>
      </div>
      <form th:action="@{/event/coupon/issue-by-code}" method="post" aria-label="7% 쿠폰 발급">
        <input type="hidden" name="code" value="AUG_7P"/>
        <div th:if="${_csrf} != null">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </div>
        <button class="btn btn-primary" type="submit"
                th:disabled="${has7 or ((issuedCount ?: 0) >= (packSize ?: 3))}"
                th:text="${has7} ? '발급 완료 ✅'
                         : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '발급받기')"
                th:aria-label="${has7} ? '이미 발급됨' : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '7% 쿠폰 발급받기')">
          발급받기
        </button>
      </form>
    </article>

    <!-- ===== 10% ===== -->
    <article class="banner" aria-labelledby="coupon10Title">
      <div class="bignum" aria-hidden="true">10%</div>
      <div>
        <div id="coupon10Title" class="line1">숙소 10% 할인 🚀</div>
        <div class="line2">12만원 이상 · 최대 40,000원</div>
        <div class="line3">사용기간: 발급일로부터 10일 (8/31 만료)</div>
      </div>
      <form th:action="@{/event/coupon/issue-by-code}" method="post" aria-label="10% 쿠폰 발급">
        <input type="hidden" name="code" value="AUG_10P"/>
        <div th:if="${_csrf} != null">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </div>
        <button class="btn btn-primary" type="submit"
                th:disabled="${has10 or ((issuedCount ?: 0) >= (packSize ?: 3))}"
                th:text="${has10} ? '발급 완료 ✅'
                         : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '발급받기')"
                th:aria-label="${has10} ? '이미 발급됨' : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '10% 쿠폰 발급받기')">
          발급받기
        </button>
      </form>
    </article>

    <!-- ===== 5,000원 (AUG_5K 그대로 유지) ===== -->
    <article class="banner" aria-labelledby="coupon5kTitle">
      <div class="bignum bignum--won" aria-hidden="true">₩5,000</div>
      <div>
        <div id="coupon5kTitle" class="line1">숙소 5,000원 할인</div>
        <div class="line2">5만원 이상 · 최대 5,000원</div>
        <div class="line3">사용기간: 발급일로부터 10일 (8/31 만료)</div>
      </div>
      <form th:action="@{/event/coupon/issue-by-code}" method="post" aria-label="5,000원 쿠폰 발급">
        <input type="hidden" name="code" value="AUG_5K"/>
        <div th:if="${_csrf} != null">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </div>
        <button class="btn btn-primary" type="submit"
                th:disabled="${has5k or ((issuedCount ?: 0) >= (packSize ?: 3))}"
                th:text="${has5k} ? '발급 완료 ✅'
                         : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '발급받기')"
                th:aria-label="${has5k} ? '이미 발급됨' : (((issuedCount ?: 0) >= (packSize ?: 3)) ? '발급 마감' : '5,000원 쿠폰 발급받기')">
          발급받기
        </button>
      </form>
    </article>

    <div class="sep" role="separator" aria-hidden="true"></div>

    <!-- ===== 추천 숙소 ===== -->
    <article class="hotel" aria-labelledby="hotelTitle">
      <img src="/image/KakaoTalk_20250801_104804478.webp"
           alt="추천 숙소 외관 이미지" loading="lazy" decoding="async" width="640" height="360">
      <div class="info">
        <div class="pill"><i class="fa-solid fa-star" aria-hidden="true"></i>추천 숙소</div>
        <h3 id="hotelTitle" class="hotel-title">서울 강남 프리미엄 호텔</h3>
        <p class="hotel-desc">
          강남역 도보 5분, 비즈니스 여행객에게 최적화된 프리미엄 호텔입니다.<br>
          최신 시설과 편리한 접근성으로 만족도 높은 숙박 경험을 제공합니다.
        </p>
      </div>
    </article>

    <!-- 플래시 메시지(서버에서 ra.addFlashAttribute 로 전달) -->
    <p class="hotel-desc" th:if="${toast}" th:text="${toast}" style="margin-top:12px; text-align:center;"></p>
  </div>
</div>
</html>
